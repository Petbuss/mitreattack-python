pid_to_tid = {
    'pid11':   ['tid101', 'tid102', 'tid103', 'tid105'],
    'pid121':  ['tid106'],
    'pid122':  ['tid107'],
    'pid123':  ['tid108'],
    'pid124':  ['tid109'],
    'pid1241': ['tid110'],
    'pid13':   ['tid113', 'tid114'],
    'pid14':   ['tid111', 'tid118'],
    'pid15':   ['tid115', 'tid116', 'tid119'],
    'pid21':   ['tid201'],
    'pid22':   ['tid224'],
    'pid23':   ['tid202', 'tid218'],
    'pid231':  ['tid203'],
    'pid2321': ['tid204'],
    'pid23221':['tid205', 'tid219'],
    'pid23222':['tid206', 'tid223'],
    'pid241':  ['tid207'],
    'pid242':  ['tid208', 'tid209'],
    'pid251':  ['tid214'],
    'pid252':  ['tid220'],
    'pid26':   ['tid210'],
    'pid271':  ['tid211'],
    'pid272':  ['tid214', 'tid330'],
    'pid2721': ['tid212'],
    'pid2722': ['tid213'],
    'pid273':  ['tid215'],
    'pid274':  ['tid216'],
    'pid275':  ['tid217'],
    'pid31':   ['tid301'],
    'pid311':  ['tid319', 'tid320', 'tid321', 'tid322', 'tid323', 'tid324', 'tid325'],
    'pid3121': ['tid326'],
    'pid3122': ['tid327'],
    'pid32':   ['tid302'],
    'pid321':  ['tid303'],
    'pid322':  ['tid304'],
    'pid3231': ['tid305'],
    'pid3232': ['tid306'],
    'pid324':  ['tid307', 'tid308', 'tid309'],
    'pid331':  ['tid310'],
    'pid332':  ['tid311', 'tid312', 'tid313', 'tid328'],
    'pid3321': ['tid314', 'tid315', 'tid329'],
    'pid3322': ['tid316', 'tid317', 'tid318', 'tid330', 'tid411'],
    'pid41':   ['tid222', 'tid310', 'tid401', 'tid404', 'tid405', 'tid407'],
    'pid4111': ['tid406'],
    'pid4112': ['tid408'],
    'pid4113': ['tid221', 'tid316', 'tid317', 'tid318', 'tid330', 'tid410', 'tid411'],
    'pid42':   ['tid412'],
}

mid_to_tid = {
    'mid001': ['tid201', 'tid203', 'tid211', 'tid213', 'tid218', 'tid301'],
    'mid002': ['tid201', 'tid203', 'tid211', 'tid213', 'tid218', 'tid301'],
    'mid003': ['tid201', 'tid203', 'tid213', 'tid218', 'tid301', 'tid302'],
    'mid004': ['tid202', 'tid206', 'tid219', 'tid327'],
    'mid005': ['tid202', 'tid206', 'tid219', 'tid327'],
    'mid006': ['tid202', 'tid327'],
    'mid007': ['tid202', 'tid206'],
    'mid008': ['tid202', 'tid309', 'tid404', 'tid405'],
    'mid009': ['tid203', 'tid218', 'tid301', 'tid302', 'tid304'],
    'mid010': ['tid203'],
    'mid011': ['tid203', 'tid113'],
    'mid012': ['tid204', 'tid205', 'tid219', 'tid304', 'tid305', 'tid306'],
    'mid013': ['tid204', 'tid304', 'tid327'],
    'mid014': ['tid103', 'tid110', 'tid202', 'tid204', 'tid205', 'tid304', 'tid305'],
    'mid015': ['tid204', 'tid205', 'tid304', 'tid305'],
    'mid016': ['tid205'],
    'mid017': ['tid205','tid308','tid315','tid412'],
    'mid018': ['tid205', 'tid224', 'tid412'],
    'mid019': ['tid206'],
    'mid020': ['tid206'],
    'mid021': ['tid208'],
    'mid022': ['tid207', 'tid306'],
    'mid023': ['tid208', 'tid209'],
    'mid024': ['tid209'],
    'mid025': ['tid210'],
    'mid026': ['tid210', 'tid211', 'tid212', 'tid213', 'tid215', 'tid217'],
    'mid027': ['tid101', 'tid102', 'tid213', 'tid316', 'tid318', 'tid330'],
    'mid028': ['tid214'],
    'mid029': ['tid201'],
    'mid030': ['tid216'],
    'mid031': ['tid217', 'tid222', 'tid302', 'tid412'],
    'mid032': ['tid217', 'tid222', 'tid404', 'tid405'],
    'mid033': ['tid212', 'tid220', 'tid317'],
    'mid034': ['tid310', 'tid406'],
    'mid035': ['tid321', 'tid408'],
    'mid036': ['tid221', 'tid407'],
    'mid037': ['tid221', 'tid407'],
    'mid038': ['tid222', 'tid302', 'tid312', 'tid313', 'tid412'],
    'mid039': ['tid224'],
    'mid040': ['tid302'],
    'mid041': ['tid302', 'tid303'],
    'mid042': ['tid303', 'tid307'],
    'mid043': ['tid311', 'tid328'],
    'mid044': ['tid330', 'tid410', 'tid411'],
    'mid046': ['tid314'],
    'mid047': ['tid317'],
    'mid049': ['tid329'],
    'mid050': ['tid103'],
    'mid051': ['tid103', 'tid110', 'tid302'],
    'mid052': ['tid106', 'tid108', 'tid109', 'tid114'],
    'mid054': ['tid106', 'tid108'],
    'mid056': ['tid111'],
    'mid057': ['tid115', 'tid116', 'tid119'],
    'mid058': ['tid115', 'tid119'],
    'mid059': ['tid101', 'tid102'],
    'mid060': ['tid101', 'tid102', 'tid214', 'tid317', 'tid318'],
    'mid061': ['tid103'],
    'mid062': ['tid105'],
    'mid063': ['tid105'],
    'mid064': ['tid106', 'tid108'],
    'mid065': ['tid106', 'tid107', 'tid109', 'tid110', 'tid223'],
    'mid066': ['tid105', 'tid110'],
    'mid067': ['tid110'],
    'mid068': ['tid114'],
    'mid069': ['tid118'],
    'mid070': ['tid107', 'tid113'],
    'mid071': ['tid319'],
    'mid072': ['tid320'],
    'mid073': ['tid321'],
    'mid074': ['tid322'],
    'mid075': ['tid323'],
    'mid076': ['tid324'],
    'mid077': ['tid326', 'tid309'],
    'mid078': ['tid325'],
    'mid079': ['tid401'],
    'mid080': ['tid405'],
    'mid081': ['tid406', 'tid408'],
    'mid082': ['tid411'],
    'mid083': ['tid412'],
}

tid_to_mid = {
    'tid101': ['mid027', 'mid059', 'mid060'],
    'tid102': ['mid027', 'mid059', 'mid060'],
    'tid103': ['mid014', 'mid050', 'mid051', 'mid061'],
    'tid105': ['mid062', 'mid063', 'mid066'],
    'tid106': ['mid052', 'mid054', 'mid064', 'mid065'],
    'tid107': ['mid065', 'mid070'],
    'tid108': ['mid052', 'mid054', 'mid064'],
    'tid109': ['mid052', 'mid065'],
    'tid110': ['mid014', 'mid051', 'mid065', 'mid066', 'mid067'],
    'tid111': ['mid056'],
    'tid113': ['mid011', 'mid070'],
    'tid114': ['mid052', 'mid068'],
    'tid115': ['mid057', 'mid058'],
    'tid116': ['mid057'],
    'tid118': ['mid069'],
    'tid119': ['mid057', 'mid058'],
    'tid201': ['mid001', 'mid002', 'mid003', 'mid029'],
    'tid202': ['mid004', 'mid005', 'mid006', 'mid007', 'mid008', 'mid014', 'mid015'],
    'tid203': ['mid001', 'mid002', 'mid003', 'mid009', 'mid010', 'mid011', 'mid009'],  
    'tid204': ['mid012', 'mid013', 'mid014', 'mid015'],
    'tid205': ['mid012', 'mid014', 'mid015', 'mid016', 'mid017', 'mid018'],
    'tid206': ['mid004', 'mid005', 'mid007', 'mid008', 'mid019', 'mid020'],
    'tid207': ['mid022'],
    'tid208': ['mid021', 'mid023'],
    'tid209': ['mid023', 'mid024'],
    'tid210': ['mid025', 'mid026'],
    'tid211': ['mid001', 'mid002', 'mid026'],
    'tid212': ['mid026', 'mid033'],
    'tid213': ['mid001', 'mid002', 'mid003', 'mid026', 'mid027'],
    'tid214': ['mid028', 'mid060'],
    'tid215': ['mid026'],
    'tid216': ['mid030'],
    'tid217': ['mid026', 'mid031', 'mid032'],
    'tid218': ['mid001', 'mid002', 'mid003', 'mid009'],
    'tid219': ['mid004', 'mid005', 'mid012'],
    'tid220': ['mid033'],
    'tid221': ['mid036','mid037'],
    'tid222': ['mid018', 'mid031', 'mid032', 'mid038'],
    'tid223': ['mid065'],
    'tid224': ['mid018', 'mid039'],
    'tid301': ['mid001', 'mid002', 'mid003', 'mid009'],
    'tid302': ['mid003', 'mid009', 'mid031', 'mid038', 'mid040', 'mid041', 'mid051'],
    'tid303': ['mid041', 'mid042'],
    'tid304': ['mid009', 'mid012', 'mid013', 'mid014', 'mid015', 'mid009'],  
    'tid305': ['mid012', 'mid014', 'mid015'],
    'tid306': ['mid012', 'mid022'],
    'tid307': ['mid042'],
    'tid308': ['mid017'],
    'tid309': ['mid008', 'mid077'],
    'tid310': ['mid034'],
    'tid311': ['mid043'],
    'tid312': ['mid038'],
    'tid313': ['mid038'],
    'tid314': ['mid046'],
    'tid315': ['mid017'],
    'tid316': ['mid027', 'mid044'],
    'tid317': ['mid033', 'mid047', 'mid060'],
    'tid318': ['mid027', 'mid060'],
    'tid319': ['mid071'],
    'tid320': ['mid072'],
    'tid321': ['mid035', 'mid073'],
    'tid322': ['mid074'],
    'tid323': ['mid075'],
    'tid324': ['mid076'],
    'tid325': ['mid078'],
    'tid326': ['mid077'],
    'tid327': ['mid004', 'mid005', 'mid006', 'mid013'],
    'tid328': ['mid043'],
    'tid329': ['mid049'],
    'tid330': ['mid027', 'mid044'],
    'tid401': ['mid079'],
    'tid404': ['mid008', 'mid032'],
    'tid405': ['mid008', 'mid032', 'mid080'],
    'tid406': ['mid034', 'mid081'],
    'tid407': ['mid036', 'mid037'],
    'tid408': ['mid035', 'mid081'],
    'tid410': ['mid044'],
    'tid411': ['mid044', 'mid082'],
    'tid412': ['mid017','mid018', 'mid031', 'mid038', 'mid083'],
}

def get_mid_from_pid(pid_list):
    tid_list = []
    for pid in pid_list:
        for tid in pid_to_tid[pid]:
            if tid not in tid_list:
                tid_list.append(tid)
    mid_list = []
    for tid in tid_list:
        for mid in tid_to_mid[tid]:
            if mid not in mid_list:
                mid_list.append(mid)
    return mid_list

pid_list = [
    'pid11', 'pid121', 'pid122', 'pid123', 'pid124',
    'pid13', 'pid14', 'pid21', 'pid22', 'pid23',
    'pid231', 'pid23221', 'pid23222', 'pid272', 'pid2722',
    'pid274', 'pid275', 'pid31', 'pid311', 'pid32',
    'pid321', 'pid322', 'pid331', 'pid332', 'pid3321',
    'pid3322', 'pid41', 'pid4113'
]
print(get_mid_from_pid(pid_list))
    
